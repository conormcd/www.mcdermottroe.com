machine:
  php:
    version: 5.6.5

dependencies:
  cache_directories:
    - vendor
  pre:
    - sed -i 's/^;//' ~/.phpenv/versions/$(phpenv global)/etc/conf.d/xdebug.ini
    - pecl install -f memcached-2.0.1

test:
  override:
    - mkdir -p $CIRCLE_TEST_REPORTS/{phpcs,phpunit}
    - vendor/bin/phpcs --standard=test/phpcs.xml --extensions=php --ignore=vendor --report=junit --report-junit=${CIRCLE_TEST_REPORTS}/phpcs/phpcs.xml .
    - vendor/bin/phpunit --verbose --log-junit ${CIRCLE_TEST_REPORTS}/phpunit/phpunit.xml:
        parallel: true
        files:
          - test/phpunit/*/*Test.php
